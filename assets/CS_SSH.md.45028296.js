import{_ as l,c as e,b as s,a,d as n,o as p}from"./app.c729a732.js";const A=JSON.parse('{"title":"SSH","description":"","frontmatter":{"title":"SSH","created_at":"2022-02-01T05:44:39.000Z","updated_at":"2022-02-11T13:01:55.000Z","word_count":2350},"headers":[{"level":2,"title":"OpenSSH","slug":"openssh","link":"#openssh","children":[]},{"level":2,"title":"配置","slug":"配置","link":"#配置","children":[]},{"level":2,"title":"端口转发（Port forwarding）","slug":"端口转发-port-forwarding","link":"#端口转发-port-forwarding","children":[{"level":3,"title":"动态转发","slug":"动态转发","link":"#动态转发","children":[]},{"level":3,"title":"远程转发","slug":"远程转发","link":"#远程转发","children":[]}]},{"level":2,"title":"简易 VPN","slug":"简易-vpn","link":"#简易-vpn","children":[]},{"level":2,"title":"ssh免密登入","slug":"ssh免密登入","link":"#ssh免密登入","children":[]}],"relativePath":"CS/SSH.md"}'),o={name:"CS/SSH.md"},r=a(`<p><strong>远程管理协议</strong></p><ul><li>RDP（remote desktop protocol，远程桌面协议）：大部分 Windows 系统都默认支持此协议，Windows 系统中的远程桌面管理就基于该协议。</li><li>RFB（Remote FrameBuffer，图形化远程管理协议）：VNC 远程管理工具基于此协议。</li><li>Telnet（命令行界面远程管理协议）：几乎所有的操作系统都默认支持此协议。数据传送使用明文传输的方式。</li><li>SSH（Secure Shell，命令行界面远程管理协议）：几乎所有操作系统都默认支持此协议。数据传输会对数据进行加密并压缩，安全快速。</li></ul><p>SSH <br> <strong>Secure Shell</strong>（安全外壳协议）是一种加密的<a href="https://zh.wikipedia.org/wiki/%E7%BD%91%E7%BB%9C%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE" target="_blank" rel="noreferrer">网络传输协议</a>，可在不安全的网络中为网络服务提供安全的传输环境</p><ul><li>通过在网络中创建安全隧道来实现SSH客户端与服务器之间的连接</li><li>以非对称加密实现身份验证</li></ul><p>协议框架</p><ul><li>传输层协议（The Transport Layer Protocol）：传输层协议提供服务器认证，数据机密性，信息完整性等的支持。</li><li>用户认证协议（The User Authentication Protocol）：用户认证协议为服务器提供客户端的身份鉴别。</li><li>连接协议（The Connection Protocol）：连接协议将加密的信息隧道复用成若干个逻辑通道，提供给更高层的应用协议使用。</li></ul><h2 id="openssh" tabindex="-1"><a href="http://www.openssh.com/" target="_blank" rel="noreferrer">OpenSSH</a> <a class="header-anchor" href="#openssh" aria-hidden="true">#</a></h2><p><strong>组件</strong></p><ul><li><a href="https://man.openbsd.org/ssh" target="_blank" rel="noreferrer">ssh</a> — The basic rlogin/rsh-like client program</li><li><a href="https://man.openbsd.org/sshd" target="_blank" rel="noreferrer">sshd</a> — The daemon that permits you to log in</li><li><a href="https://man.openbsd.org/ssh-agent" target="_blank" rel="noreferrer">ssh-agent</a> — An authentication agent that can store private keys</li><li><a href="https://man.openbsd.org/ssh-add" target="_blank" rel="noreferrer">ssh-add</a> — Tool which adds keys to in the above agent</li><li><a href="https://man.openbsd.org/sftp" target="_blank" rel="noreferrer">sftp</a> — FTP-like program that works over SSH1 and SSH2 protocol</li><li><a href="https://man.openbsd.org/scp" target="_blank" rel="noreferrer">scp</a> — File copy program that acts like rcp</li><li><a href="https://man.openbsd.org/ssh-keygen" target="_blank" rel="noreferrer">ssh-keygen</a> — Key generation tool</li><li><a href="https://man.openbsd.org/sftp-server" target="_blank" rel="noreferrer">sftp-server</a> — SFTP server subsystem (started automatically by sshd)</li><li><a href="https://man.openbsd.org/ssh-keyscan" target="_blank" rel="noreferrer">ssh-keyscan</a> — Utility for gathering public host keys from a number of hosts</li><li><a href="https://man.openbsd.org/ssh-keysign" target="_blank" rel="noreferrer">ssh-keysign</a> — Helper program for host-based authentication</li></ul><p><strong>ssh</strong> [-46AaCfGgKkMNnqsTtVvXxYy] [-B bind_interface]</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#abb2bf;">[-b bind_address] [-c cipher_spec] [-D [bind_address:]port]</span></span>
<span class="line"><span style="color:#abb2bf;">       [-E log_file] [-e escape_char] [-F configfile] [-I pkcs11]</span></span>
<span class="line"><span style="color:#abb2bf;">       [-i identity_file] [-J [user@]host[:port]] [-L address]</span></span>
<span class="line"><span style="color:#abb2bf;">       [-l login_name] [-m mac_spec] [-O ctl_cmd] [-o option] [-p port]</span></span>
<span class="line"><span style="color:#abb2bf;">       [-Q query_option] [-R address] [-S ctl_path] [-W host:port]</span></span>
<span class="line"><span style="color:#abb2bf;">       [-w local_tun[:remote_tun]] destination [command]</span></span>
<span class="line"><span style="color:#abb2bf;"></span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>ssh-keygen</strong> [-q] [-a rounds] [-b bits] [-C comment] [-f output_keyfile] [-m format] [-N new_passphrase] [-O option] [-t dsa | ecdsa | ecdsa-sk | ed25519 | ed25519-sk | rsa] [-w provider] [-Z cipher] <br> <strong>ssh-keygen</strong> -R hostname [-f known_hosts_file]    Removes all keys belonging to the specified hostname (with optional port number) from a known_hosts file <br> <strong>scp</strong> [-346BCpqrv] [-c cipher] [-F ssh_config] [-i identity_file] <br> [-l limit] [-o ssh_option] [-P port] [-S program] source ... target <br> <a href="https://man.openbsd.org/scp#r" target="_blank" rel="noreferrer">-r    </a>Recursively copy entire directories. Note that scp follows symbolic links encountered in the tree traversal.</p><p><strong>ssh-copy-id</strong> [-h|-?|-f|-n] [-i [identity_file]] [-p port] [[-o ] ...] [user@]hostname <br> 自动将公钥拷贝到远程服务器的~/.ssh/authorized_keys文件(authorized_keys文件的末尾必须是换行符) <br> 查看公钥的指纹</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#E06C75;">ssh</span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">keygen</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">l</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">f</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">/</span><span style="color:#E06C75;">etc</span><span style="color:#56B6C2;">/</span><span style="color:#E06C75;">ssh</span><span style="color:#56B6C2;">/</span><span style="color:#E5C07B;">ssh_host_ecdsa_key</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pub</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>SSH 连接的握手阶段，客户端必须跟服务端约定加密参数集（cipher suite）</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#E5C07B;">TLS_RSA_WITH_AES_128_CBC_SHA</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>TLS：协议</li><li>RSA：密钥交换算法</li><li>AES：加密算法</li><li>128：加密强度</li><li>CBC：加密模式</li><li>SHA：数字签名的 Hash 函数</li></ul><h2 id="配置" tabindex="-1">配置 <a class="header-anchor" href="#配置" aria-hidden="true">#</a></h2><p>每个命令占据一行。 <br> 每行都是配置项和对应的值，配置项的大小写不敏感，与值之间使用空格分隔。 <br> 配置项与值之间有一个等号，等号前后的空格可选。 <br> #开头的行表示注释，只能放在一行的开头 <br> <a href="https://man.openbsd.org/ssh_config" target="_blank" rel="noreferrer">ssh_config</a> — The client configuration file</p><h4 id="配置命令" tabindex="-1">配置命令 <a class="header-anchor" href="#配置命令" aria-hidden="true">#</a></h4><ul><li>AddressFamily inet：使用 IPv4 协议。如果设为inet6，表示只使用 IPv6 协议。</li><li>BindAddress 192.168.10.235：指定本机的 IP 地址（如果本机有多个 IP 地址）。</li><li>CheckHostIP yes：检查 SSH 服务器的 IP 地址是否跟公钥数据库吻合。</li><li>Ciphers blowfish,3des：指定加密算法。</li><li>Compression yes：是否压缩传输信号。</li><li>ConnectionAttempts 10：客户端进行连接时，最大的尝试次数。</li><li>ConnectTimeout 60：客户端进行连接时，服务器在指定秒数内没有回复，则中断连接尝试。</li><li>DynamicForward 1080：指定动态转发端口。</li><li>GlobalKnownHostsFile /users/smith/.ssh/my_global_hosts_file：指定全局的公钥数据库文件的位置。</li><li>Host <a href="http://server.example.com" target="_blank" rel="noreferrer">server.example.com</a>：指定连接的域名或 IP 地址，也可以是别名，支持通配符。Host命令后面的所有配置，都是针对该主机的，直到下一个Host命令为止。</li><li>HostKeyAlgorithms ssh-dss,ssh-rsa：指定密钥算法，优先级从高到低排列。</li><li>HostName <a href="http://myserver.example.com" target="_blank" rel="noreferrer">myserver.example.com</a>：在Host命令使用别名的情况下，HostName指定域名或 IP 地址。</li><li>IdentityFile keyfile：指定私钥文件。</li><li>LocalForward 2001 localhost:143：指定本地端口转发。</li><li>LogLevel QUIET：指定日志详细程度。如果设为QUIET，将不输出大部分的警告和提示。</li><li>MACs hmac-sha1,hmac-md5：指定数据校验算法。</li><li>NumberOfPasswordPrompts 2：密码登录时，用户输错密码的最大尝试次数。</li><li>PasswordAuthentication no：指定是否支持密码登录。不过，这里只是客户端禁止，真正的禁止需要在 SSH 服务器设置。</li><li>Port 2035：指定客户端连接的 SSH 服务器端口。</li><li>PreferredAuthentications publickey,hostbased,password：指定各种登录方法的优先级。</li><li>Protocol 2：支持的 SSH 协议版本，多个版本之间使用逗号分隔。</li><li>PubKeyAuthentication yes：是否支持密钥登录。这里只是客户端设置，还需要在 SSH 服务器进行相应设置。</li><li>RemoteForward 2001 server:143：指定远程端口转发。</li><li>SendEnv COLOR：SSH 客户端向服务器发送的环境变量名，多个环境变量之间使用空格分隔。环境变量的值从客户端当前环境中拷贝。</li><li>ServerAliveCountMax 3：如果没有收到服务器的回应，客户端连续发送多少次keepalive信号，才断开连接。默认值为3。</li><li>ServerAliveInterval 300：客户端建立连接后，如果在给定秒数内，没有收到服务器发来的消息，客户端向服务器发送keepalive消息。如果不希望客户端发送，这一项设为0。</li><li>StrictHostKeyChecking yes：yes表示严格检查，服务器公钥为未知或发生变化，则拒绝连接。no表示如果服务器公钥未知，则加入客户端公钥数据库，如果公钥发生变化，不改变客户端公钥数据库，输出一条警告，依然允许连接继续进行。ask（默认值）表示询问用户是否继续进行。</li><li>TCPKeepAlive yes：客户端是否定期向服务器发送keepalive信息。</li><li>User userName：指定远程登录的账户名。</li><li>UserKnownHostsFile /users/smith/.ssh/my_local_hosts_file：指定当前用户的known_hosts文件（服务器公钥指纹列表）的位置。</li><li>VerifyHostKeyDNS yes：是否通过检查 SSH 服务器的 DNS 记录，确认公钥指纹是否与known_hosts文件保存的一致。</li></ul><p><a href="https://man.openbsd.org/sshd_config" target="_blank" rel="noreferrer">sshd_config</a> — The daemon configuration file</p><h2 id="端口转发-port-forwarding" tabindex="-1">端口转发（Port forwarding） <a class="header-anchor" href="#端口转发-port-forwarding" aria-hidden="true">#</a></h2><p>又称 SSH 隧道（tunnel）</p><h3 id="动态转发" tabindex="-1">动态转发 <a class="header-anchor" href="#动态转发" aria-hidden="true">#</a></h3><p>本机与 SSH 服务器之间创建了一个加密连接，然后本机内部针对某个端口的通信，都通过这个加密连接转发。</p><p>命令</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#E06C75;">ssh</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">-</span><span style="color:#E5C07B;">D</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">local</span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">port</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">tunnel</span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">host</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">-</span><span style="color:#E5C07B;">N</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>需要把 HTTP 请求转成 SOCKS5 协议，才能把本地端口的请求转发出去 <br> 示例</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#E06C75;">curl</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">x</span><span style="color:#ABB2BF;"> socks5:</span><span style="color:#7F848E;font-style:italic;">//localhost:2121 http://www.example.com</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>配置</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#E06C75;">DynamicForward</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">tunnel</span><span style="color:#56B6C2;">-</span><span style="color:#ABB2BF;">host:</span><span style="color:#E06C75;">local</span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">port</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div>`,32),t=n("br",null,null,-1),c=n("br",null,null,-1),i=a(`<h3 id="远程转发" tabindex="-1">远程转发 <a class="header-anchor" href="#远程转发" aria-hidden="true">#</a></h3><p>命令</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#E06C75;">ssh</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">-</span><span style="color:#E5C07B;">R</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">local</span><span style="color:#56B6C2;">-</span><span style="color:#ABB2BF;">port:</span><span style="color:#E06C75;">target</span><span style="color:#56B6C2;">-</span><span style="color:#ABB2BF;">host:</span><span style="color:#E06C75;">target</span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">port</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">-</span><span style="color:#E5C07B;">N</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">local</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>配置</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#E06C75;">Host</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">test</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">example</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">com</span></span>
<span class="line"><span style="color:#E06C75;">RemoteForward</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">local</span><span style="color:#56B6C2;">-</span><span style="color:#ABB2BF;">IP:</span><span style="color:#E06C75;">local</span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">port</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">target</span><span style="color:#56B6C2;">-</span><span style="color:#ABB2BF;">ip:</span><span style="color:#E06C75;">target</span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">port</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="简易-vpn" tabindex="-1">简易 VPN <a class="header-anchor" href="#简易-vpn" aria-hidden="true">#</a></h2><p>VPN 用来在外网与内网之间建立一条加密通道。内网的服务器不能从外网直接访问，必须通过一个跳板机，如果本机可以访问跳板机，就可以使用 SSH 本地转发，简单实现一个 VPN。</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#E06C75;">ssh</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">-</span><span style="color:#E5C07B;">L</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">2080</span><span style="color:#ABB2BF;">:</span><span style="color:#E06C75;">corp</span><span style="color:#56B6C2;">-</span><span style="color:#ABB2BF;">server:</span><span style="color:#D19A66;">80</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">-</span><span style="color:#E5C07B;">L</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">2443</span><span style="color:#ABB2BF;">:</span><span style="color:#E06C75;">corp</span><span style="color:#56B6C2;">-</span><span style="color:#ABB2BF;">server:</span><span style="color:#D19A66;">443</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">tunnel</span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">host</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">-</span><span style="color:#E5C07B;">N</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>上面命令通过 SSH 跳板机，将本机的2080端口绑定内网服务器的80端口，本机的2443端口绑定内网服务器的443端口。</p><h2 id="ssh免密登入" tabindex="-1">ssh免密登入 <a class="header-anchor" href="#ssh免密登入" aria-hidden="true">#</a></h2><p>1 本机生成密钥对</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#E06C75;">ssh</span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">keygen</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">t</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">rsa</span><span style="color:#ABB2BF;">   # </span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">t表示类型选项</span><span style="color:#ABB2BF;">，</span><span style="color:#E06C75;">这里采用rsa加密算法</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>然后根据提示一步步的按enter键即可，执行结束以后会在 /home/user 下生成一个 .ssh 文件夹，包含私钥文件 id_rsa 和公钥文件 id_rsa.pub。</p><p>2 将公钥复制到远程主机中 <br> ssh-copy-id 将公钥写到远程主机的 ~/ .ssh/authorized_key 文件中</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#E06C75;">ssh</span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">copy</span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">id</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">ldz</span><span style="color:#ABB2BF;">@</span><span style="color:#D19A66;">192.168</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">0.1</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>本机 .ssh/config</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#ABB2BF;"># </span><span style="color:#E06C75;">别名</span><span style="color:#ABB2BF;">（</span><span style="color:#E06C75;">Host</span><span style="color:#ABB2BF;">）：</span><span style="color:#E06C75;">Host</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">和</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">HostName</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">的值可以相同</span></span>
<span class="line"><span style="color:#ABB2BF;"># </span><span style="color:#E06C75;">如</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">ssh</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">aliyun</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">等于</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">ssh</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> C:\\</span><span style="color:#E06C75;">Users</span><span style="color:#ABB2BF;">\\</span><span style="color:#E06C75;">泷</span><span style="color:#ABB2BF;">\\.</span><span style="color:#E06C75;">ssh</span><span style="color:#ABB2BF;">\\</span><span style="color:#E06C75;">id_rsa_aliyun</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">root</span><span style="color:#ABB2BF;">@</span><span style="color:#D19A66;">172.20</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">217.87</span></span>
<span class="line"><span style="color:#ABB2BF;"># </span><span style="color:#E06C75;">每项配置都是参数名</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">参数值或参数值</span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;">参数名的形式</span><span style="color:#ABB2BF;">，</span><span style="color:#E06C75;">其中参数名不区分大小写</span><span style="color:#ABB2BF;">，</span><span style="color:#E06C75;">而参数值区分大小写</span></span>
<span class="line"><span style="color:#E06C75;">Host</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">vm</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">User</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">darkiny</span><span style="color:#ABB2BF;">				# </span><span style="color:#E06C75;">用户名</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">HostName</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">172.20</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">217.87</span><span style="color:#ABB2BF;">			# </span><span style="color:#E06C75;">主机地址</span></span>
<span class="line"><span style="color:#ABB2BF;">    # </span><span style="color:#E06C75;">IdentityFile</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;~/.ssh/id_rsa&quot;</span><span style="color:#ABB2BF;">	# </span><span style="color:#E06C75;">认证文件</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;">私钥文件位置</span></span>
<span class="line"><span style="color:#ABB2BF;">    # </span><span style="color:#E06C75;">Port</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">22</span><span style="color:#ABB2BF;">                      # </span><span style="color:#E06C75;">指定端口</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>Windows</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#ABB2BF;">查看</span></span>
<span class="line"><span style="color:#ABB2BF;">Get-WindowsCapability </span><span style="color:#D19A66;">-Online</span><span style="color:#ABB2BF;"> | ? </span><span style="color:#98C379;">Name</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">-like</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;OpenSSH*&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">安装</span></span>
<span class="line"><span style="color:#ABB2BF;">Add-WindowsCapability </span><span style="color:#D19A66;">-Online</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">-Name</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">OpenSSH.Server~~~~0.0.1.0</span></span>
<span class="line"><span style="color:#ABB2BF;">开启 </span><span style="color:#98C379;">SSHD</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">服务</span></span>
<span class="line"><span style="color:#ABB2BF;">Start-Service </span><span style="color:#98C379;">sshd</span></span>
<span class="line"><span style="color:#ABB2BF;">设置服务开机自启</span></span>
<span class="line"><span style="color:#ABB2BF;">Set-Service </span><span style="color:#D19A66;">-Name</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">sshd</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">-StartupType</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;Automatic&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">确认防火墙是否是开放（ </span><span style="color:#98C379;">OpenSSH-Server-In-TCP</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">是</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">enabled</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">）</span></span>
<span class="line"><span style="color:#ABB2BF;">Get-NetFirewallRule </span><span style="color:#D19A66;">-Name</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">*</span><span style="color:#98C379;">ssh</span><span style="color:#E5C07B;">*</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div>`,19);function B(y,d,h,b,u,C){return p(),e("div",null,[r,s(),t,s(" ### 本地转发（local forwarding） SSH 服务器作为中介的跳板机，建立本地计算机与特定目标网站之间的加密连接。 "),c,s(" 命令 ```javascript ssh -L local-port:target-host:target-port tunnel-host ``` 配置 ```javascript Host test.example.com LocalForward client-IP:client-port server-IP:server-port ``` "),i])}const g=l(o,[["render",B]]);export{A as __pageData,g as default};
