import{_ as s,c as n,o as a,N as l}from"./chunks/framework.54f528ff.js";const C=JSON.parse('{"title":"ORM","description":"","frontmatter":{"title":"ORM","created_at":"2023-03-05T10:49:15.000Z","updated_at":"2023-03-05T11:21:36.000Z","word_count":3732},"headers":[],"relativePath":"CS/ORM.md"}'),p={name:"CS/ORM.md"},o=l(`<h2 id="——-orm-——" tabindex="-1">—— ORM —— <a class="header-anchor" href="#——-orm-——" aria-label="Permalink to &quot;—— ORM ——&quot;">​</a></h2><h3 id="hibernate" tabindex="-1"><a href="http://hibernate.org/orm/" target="_blank" rel="noreferrer">Hibernate</a> <a class="header-anchor" href="#hibernate" aria-label="Permalink to &quot;[Hibernate](http://hibernate.org/orm/)&quot;">​</a></h3><h4 id="hql" tabindex="-1">HQL <a class="header-anchor" href="#hql" aria-label="Permalink to &quot;HQL&quot;">​</a></h4><p><a href="https://hibernate.net.cn/docs/72.html" target="_blank" rel="noreferrer">大小写敏感性</a>：除了Java类与属性的名称外，查询语句对大小写并不敏感 <br> <a href="https://hibernate.net.cn/docs/73.html" target="_blank" rel="noreferrer">from子句</a></p><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#7F848E;font-style:italic;">-- 返回Cat类的所有实例，同时返回其子类的实例</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> Cat cat</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">-- 查询结果是产生一个笛卡儿积或产生跨表的连接</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> Formula, Parameter</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><a href="https://hibernate.net.cn/docs/74.html" target="_blank" rel="noreferrer">关联(Association)与连接(Join)</a></p><ul><li>inner join（内连接）</li><li>left outer join（左外连接）</li><li>right outer join（右外连接）</li><li>full join (全连接，并不常用)</li></ul><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#7F848E;font-style:italic;">-- with关键字，可以提供额外的join条件</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> Cat </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> cat </span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">left join</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">cat</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">kittens</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> kitten </span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">with</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">kitten</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">bodyWeight</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">0</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">-- &quot;fetch&quot;连接允许仅仅使用一个选择语句就将相关联的对象或一组值的集合随着他们的父对象的初始化而被初始化</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> Cat </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> cat </span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">inner join</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">fetch</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">cat</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">mate</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">left join</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">fetch</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">cat</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">kittens</span><span style="color:#ABB2BF;"> child</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">left join</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">fetch</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">child</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">kittens</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><a href="https://hibernate.net.cn/docs/76.html" target="_blank" rel="noreferrer">select子句</a></p><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#C678DD;">select</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">cat</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">name</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> DomesticCat cat</span></span>
<span class="line"><span style="color:#C678DD;">where</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">cat</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">name</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">like</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;fri%&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">-- 存放在一个List对象中</span></span>
<span class="line"><span style="color:#C678DD;">select</span><span style="color:#ABB2BF;"> new list(mother, offspr, </span><span style="color:#D19A66;">mate</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">name</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> DomesticCat </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> mother</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">inner join</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">mother</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">mate</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> mate</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">left outer join</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">mother</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">kittens</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> offspr</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">-- 假设类Family有一个合适的构造函数，可直接返回一个实际的类型</span></span>
<span class="line"><span style="color:#C678DD;">select</span><span style="color:#ABB2BF;"> new Family(mother, mate, offspr)</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> DomesticCat </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> mother</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">join</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">mother</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">mate</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> mate</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">left join</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">mother</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">kittens</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> offspr</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">-- 返回了一个Map的对象</span></span>
<span class="line"><span style="color:#C678DD;">select</span><span style="color:#ABB2BF;"> new map( </span><span style="color:#56B6C2;">max</span><span style="color:#ABB2BF;">(bodyWeight) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> max, </span><span style="color:#56B6C2;">min</span><span style="color:#ABB2BF;">(bodyWeight) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> min, </span><span style="color:#56B6C2;">count</span><span style="color:#ABB2BF;">(*) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> n )</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> Cat cat</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">-- 条件查询</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> Cat cat </span><span style="color:#C678DD;">where</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">cat</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">mate</span><span style="color:#ABB2BF;">.</span><span style="color:#C678DD;">name</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">is not null</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> Person </span><span style="color:#C678DD;">where</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">name</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> (</span><span style="color:#98C379;">&#39;Gavin&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;A&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;King&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">-- equal to</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> Person </span><span style="color:#C678DD;">where</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">name</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">first</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;Gavin&#39;</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">and</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">name</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">initial</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;A&#39;</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">and</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">name</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">last</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;King&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p><a href="https://hibernate.net.cn/docs/83.html" target="_blank" rel="noreferrer">子查询</a> <br> HQL自查询只可以在select或者where子句中出现</p><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> Cat </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> fatcat </span></span>
<span class="line"><span style="color:#C678DD;">where</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">fatcat</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">weight</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">&gt;</span><span style="color:#ABB2BF;"> ( </span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">select</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">avg</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">cat</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">weight</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> DomesticCat cat </span></span>
<span class="line"><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">select</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">cat</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">id</span><span style="color:#ABB2BF;">, (</span><span style="color:#C678DD;">select</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">max</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">kit</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">weight</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">cat</span><span style="color:#ABB2BF;">.</span><span style="color:#D19A66;">kitten</span><span style="color:#ABB2BF;"> kit) </span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> Cat </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> cat</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><a href="https://hibernate.net.cn/docs/86.html" target="_blank" rel="noreferrer"><br></a></p><h3 id="mybatis" tabindex="-1"><a href="https://mybatis.org/mybatis-3/zh/index.html" target="_blank" rel="noreferrer">MyBatis</a> <a class="header-anchor" href="#mybatis" aria-label="Permalink to &quot;[MyBatis](https://mybatis.org/mybatis-3/zh/index.html)&quot;">​</a></h3><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">dependency</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">  &lt;</span><span style="color:#E06C75;">groupId</span><span style="color:#ABB2BF;">&gt;org.mybatis&lt;/</span><span style="color:#E06C75;">groupId</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">  &lt;</span><span style="color:#E06C75;">artifactId</span><span style="color:#ABB2BF;">&gt;mybatis&lt;/</span><span style="color:#E06C75;">artifactId</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">  &lt;</span><span style="color:#E06C75;">version</span><span style="color:#ABB2BF;">&gt;3.5.4&lt;/</span><span style="color:#E06C75;">version</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;/</span><span style="color:#E06C75;">dependency</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#ABB2BF;">&lt;?</span><span style="color:#E06C75;">xml</span><span style="color:#D19A66;"> version</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;1.0&quot;</span><span style="color:#D19A66;"> encoding</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;utf-8&quot;</span><span style="color:#ABB2BF;">?&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;!</span><span style="color:#C678DD;">DOCTYPE</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">configuration</span><span style="color:#ABB2BF;"> PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">configuration</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#7F848E;font-style:italic;">&lt;!-- 配置 --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">properties</span><span style="color:#ABB2BF;"> /&gt;</span><span style="color:#7F848E;font-style:italic;">&lt;!-- 属性 --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">settings</span><span style="color:#ABB2BF;"> /&gt;</span><span style="color:#7F848E;font-style:italic;">&lt;!-- 设置 --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">typeAliases</span><span style="color:#ABB2BF;"> /&gt;</span><span style="color:#7F848E;font-style:italic;">&lt;!-- 类型命名 --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">typeHandlers</span><span style="color:#ABB2BF;"> /&gt;</span><span style="color:#7F848E;font-style:italic;">&lt;!-- 类型处理器 --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">objectFactory</span><span style="color:#ABB2BF;"> /&gt;</span><span style="color:#7F848E;font-style:italic;">&lt;!-- 对象工厂 --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">plugins</span><span style="color:#ABB2BF;"> /&gt;</span><span style="color:#7F848E;font-style:italic;">&lt;!-- 插件 --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">environments</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#7F848E;font-style:italic;">&lt;!-- 配置环境 --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">        &lt;</span><span style="color:#E06C75;">environment</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#7F848E;font-style:italic;">&lt;!-- 环境变量 --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">            &lt;</span><span style="color:#E06C75;">transactionManager</span><span style="color:#ABB2BF;"> /&gt;</span><span style="color:#7F848E;font-style:italic;">&lt;!-- 事务管理器 --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">            &lt;</span><span style="color:#E06C75;">dataSource</span><span style="color:#ABB2BF;"> /&gt;</span><span style="color:#7F848E;font-style:italic;">&lt;!-- 数据源 --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">        &lt;/</span><span style="color:#E06C75;">environment</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;/</span><span style="color:#E06C75;">environments</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">databaseIdProvider</span><span style="color:#ABB2BF;"> /&gt;</span><span style="color:#7F848E;font-style:italic;">&lt;!-- 数据库厂商标识 --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">mappers</span><span style="color:#ABB2BF;"> /&gt;</span><span style="color:#7F848E;font-style:italic;">&lt;!-- 映射器 --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;/</span><span style="color:#E06C75;">configuration</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>** 元素的结构**</p><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">resultMap</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">id</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">type</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">constructor</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#7F848E;font-style:italic;">&lt;!-- 类再实例化时用来注入结果到构造方法 --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">        &lt;</span><span style="color:#E06C75;">idArg</span><span style="color:#ABB2BF;">/&gt;</span><span style="color:#7F848E;font-style:italic;">&lt;!-- ID参数，结果为ID --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">        &lt;</span><span style="color:#E06C75;">arg</span><span style="color:#ABB2BF;">/&gt;</span><span style="color:#7F848E;font-style:italic;">&lt;!-- 注入到构造方法的一个普通结果 --&gt;</span><span style="color:#ABB2BF;">  </span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;/</span><span style="color:#E06C75;">constructor</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">id</span><span style="color:#ABB2BF;">/&gt;</span><span style="color:#7F848E;font-style:italic;">&lt;!-- 用于表示哪个列是主键 --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">result</span><span style="color:#ABB2BF;">/&gt;</span><span style="color:#7F848E;font-style:italic;">&lt;!-- 注入到字段或JavaBean属性的普通结果 --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">association</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">property</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">/&gt;</span><span style="color:#7F848E;font-style:italic;">&lt;!-- 用于一对一关联 --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">collection</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">property</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">/&gt;</span><span style="color:#7F848E;font-style:italic;">&lt;!-- 用于一对多、多对多关联 --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">discriminator</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">javaType</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#7F848E;font-style:italic;">&lt;!-- 使用结果值来决定使用哪个结果映射 --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">        &lt;</span><span style="color:#E06C75;">case</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">value</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">/&gt;</span><span style="color:#7F848E;font-style:italic;">&lt;!-- 基于某些值的结果映射 --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;/</span><span style="color:#E06C75;">discriminator</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;/</span><span style="color:#E06C75;">resultMap</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>增删查改 <br> mybatis-config.xml</p><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#ABB2BF;">&lt;?</span><span style="color:#E06C75;">xml</span><span style="color:#D19A66;"> version</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;1.0&quot;</span><span style="color:#D19A66;"> encoding</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;UTF-8&quot;</span><span style="color:#ABB2BF;"> ?&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;!</span><span style="color:#C678DD;">DOCTYPE</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">configuration</span></span>
<span class="line"><span style="color:#ABB2BF;">  PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">  &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">configuration</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">typeAliases</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">	&lt;</span><span style="color:#E06C75;">typeAlias</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">alias</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;Site&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">type</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;rain.Site&quot;</span><span style="color:#ABB2BF;"> /&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">	&lt;/</span><span style="color:#E06C75;">typeAliases</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">  &lt;</span><span style="color:#E06C75;">environments</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">default</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;development&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">environment</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">id</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;development&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">      &lt;</span><span style="color:#E06C75;">transactionManager</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">type</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;JDBC&quot;</span><span style="color:#ABB2BF;">/&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">      &lt;</span><span style="color:#E06C75;">dataSource</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">type</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;POOLED&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">        &lt;</span><span style="color:#E06C75;">property</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">name</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;driver&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">value</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;com.mysql.cj.jdbc.Driver&quot;</span><span style="color:#ABB2BF;">/&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">        &lt;</span><span style="color:#E06C75;">property</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">name</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;url&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">value</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;jdbc:mysql://localhost:3306/web?useSSL=false</span><span style="color:#D19A66;">&amp;</span><span style="color:#E06C75;">amp</span><span style="color:#D19A66;">;</span><span style="color:#98C379;">serverTimezone=GMT&quot;</span><span style="color:#ABB2BF;">/&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">        &lt;</span><span style="color:#E06C75;">property</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">name</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;username&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">value</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;root&quot;</span><span style="color:#ABB2BF;">/&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">        &lt;</span><span style="color:#E06C75;">property</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">name</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;password&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">value</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;mysql2020&quot;</span><span style="color:#ABB2BF;">/&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">      &lt;/</span><span style="color:#E06C75;">dataSource</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;/</span><span style="color:#E06C75;">environment</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">  &lt;/</span><span style="color:#E06C75;">environments</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">  &lt;</span><span style="color:#E06C75;">mappers</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">mapper</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">resource</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;rain/SiteMapper.xml&quot;</span><span style="color:#ABB2BF;">/&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">  &lt;/</span><span style="color:#E06C75;">mappers</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;/</span><span style="color:#E06C75;">configuration</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>SiteMapper.xml</p><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#ABB2BF;">&lt;?</span><span style="color:#E06C75;">xml</span><span style="color:#D19A66;"> version</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;1.0&quot;</span><span style="color:#D19A66;"> encoding</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;UTF-8&quot;</span><span style="color:#ABB2BF;">?&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;!</span><span style="color:#C678DD;">DOCTYPE</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">mapper</span><span style="color:#ABB2BF;"> PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; </span></span>
<span class="line"><span style="color:#ABB2BF;">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">mapper</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">namespace</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;rain.ISite&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">	&lt;</span><span style="color:#E06C75;">select</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">id</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;getSite&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">parameterType</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;int&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">resultType</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;Site&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">		select *</span></span>
<span class="line"><span style="color:#ABB2BF;">		from \`site\` where id = #{id}</span></span>
<span class="line"><span style="color:#ABB2BF;">	&lt;/</span><span style="color:#E06C75;">select</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">	&lt;</span><span style="color:#E06C75;">insert</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">id</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;insertSite&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">parameterType</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;Site&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">		INSERT INTO SITE(id,name,url) VALUES(#{id},#{name},#{url})</span></span>
<span class="line"><span style="color:#ABB2BF;">	&lt;/</span><span style="color:#E06C75;">insert</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">	&lt;</span><span style="color:#E06C75;">select</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">id</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;getSites&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">resultType</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;Site&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">		SELECT * FROM SITE</span></span>
<span class="line"><span style="color:#ABB2BF;">	&lt;/</span><span style="color:#E06C75;">select</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">	&lt;</span><span style="color:#E06C75;">update</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">id</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;updateSite&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">parameterType</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;Site&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">		update site set name=#{name},url=#{url} where id=#{id}</span></span>
<span class="line"><span style="color:#ABB2BF;">	&lt;/</span><span style="color:#E06C75;">update</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">	&lt;</span><span style="color:#E06C75;">delete</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">id</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;deleteSite&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">parameterType</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;int&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">		delete from site where id=#{id}</span></span>
<span class="line"><span style="color:#ABB2BF;">	&lt;/</span><span style="color:#E06C75;">delete</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;/</span><span style="color:#E06C75;">mapper</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#C678DD;">public</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">interface</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">ISite</span><span style="color:#E06C75;"> </span><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#C678DD;">public</span><span style="color:#61AFEF;"> List</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">Site</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#61AFEF;">getSites</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#C678DD;">public</span><span style="color:#61AFEF;"> </span><span style="color:#C678DD;">void</span><span style="color:#61AFEF;"> insertSite</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">Site</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">s</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#C678DD;">public</span><span style="color:#61AFEF;"> </span><span style="color:#C678DD;">void</span><span style="color:#61AFEF;"> updateSite</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">Site</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">s</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#C678DD;">public</span><span style="color:#61AFEF;"> </span><span style="color:#C678DD;">void</span><span style="color:#61AFEF;"> deleteSite</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">int</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">id</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#C678DD;">public</span><span style="color:#61AFEF;"> </span><span style="color:#E5C07B;">Site</span><span style="color:#61AFEF;"> getSite</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">int</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">id</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#C678DD;">public</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">class</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">Test</span><span style="color:#E06C75;"> </span><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#C678DD;">public</span><span style="color:#61AFEF;"> </span><span style="color:#C678DD;">static</span><span style="color:#61AFEF;"> </span><span style="color:#C678DD;">void</span><span style="color:#61AFEF;"> main</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">String</span><span style="color:#ABB2BF;">[] </span><span style="color:#E06C75;font-style:italic;">args</span><span style="color:#ABB2BF;">)</span><span style="color:#61AFEF;"> </span><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">try</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">// 读取配置文件 mybatis-config.xml</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">InputStream</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">config</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Resources</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getResourceAsStream</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;mybatis-config.xml&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">// 根据配置文件构建SqlSessionFactory</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">SqlSessionFactory</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">ssf</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">new</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">SqlSessionFactoryBuilder</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">build</span><span style="color:#ABB2BF;">(config);</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">// 通过 SqlSessionFactory 创建 SqlSession</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">SqlSession</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">ss</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">ssf</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">openSession</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">// SqlSession执行映射文件中定义的SQL，并返回映射结果</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">ISite</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">mapper</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">ss</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getMapper</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">ISite</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">class</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">Site</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">t</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">new</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">Site</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">99</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;zhihu&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;www.zhihu.com&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">mapper</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">insertSite</span><span style="color:#ABB2BF;">(t);</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">t</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">setId</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">mapper</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">updateSite</span><span style="color:#ABB2BF;">(t);</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">mapper</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">deleteSite</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">//提交事务</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">ss</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">commit</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">var</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">r</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">mapper</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getSites</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">var</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">x</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">:</span><span style="color:#ABB2BF;"> r)</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E5C07B;">System</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">out</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">println</span><span style="color:#ABB2BF;">(x);</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">// 关闭 SqlSession</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">ss</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">close</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">        } </span><span style="color:#C678DD;">catch</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">IOException</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">e</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">// TODO Auto-generated catch block</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">e</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">printStackTrace</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p>动态SQL</p><ul><li>if</li><li>choose (when, otherwise)</li><li>trim (where, set)</li><li>foreach</li></ul><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">select</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">id</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;findActiveBlogWithTitleLike&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">resultType</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;Blog&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">  SELECT * FROM BLOG</span></span>
<span class="line"><span style="color:#ABB2BF;">  WHERE state = ‘ACTIVE’</span></span>
<span class="line"><span style="color:#ABB2BF;">  &lt;</span><span style="color:#E06C75;">if</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">test</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;title != null&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    AND title like #{title}</span></span>
<span class="line"><span style="color:#ABB2BF;">  &lt;/</span><span style="color:#E06C75;">if</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;/</span><span style="color:#E06C75;">select</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="jpa" tabindex="-1"><a href="https://docs.spring.io/spring-data/jpa/docs/current/reference/html/" target="_blank" rel="noreferrer">JPA</a> <a class="header-anchor" href="#jpa" aria-label="Permalink to &quot;[JPA](https://docs.spring.io/spring-data/jpa/docs/current/reference/html/)&quot;">​</a></h2><p>Java Persistence API（Java 持久化 API）：定义了对象关系映射（ORM）以及实体对象持久化的标准接口 <br> Spirng Data JPA 是 Spring 提供的一套简化 JPA 开发的框架，可以理解为对 JPA 规范的再次封装抽象，底层还是使用了 Hibernate 的 JPA 技术实现</p><h3 id="注解" tabindex="-1">注解 <a class="header-anchor" href="#注解" aria-label="Permalink to &quot;注解&quot;">​</a></h3><p>javax.persistence</p><ul><li><p>实体</p><ul><li>@Entity：表示该类是一个实体类</li><li>@MappedSuperclass</li><li>@Table(name)：指定该类对应数据库中的表名，如果类名和数据库表名符合驼峰及下划线规则，可省略</li><li>@SecondaryTable(name , pkJoinColumns = @PrimaryKeyJoinColumn(name ))</li></ul></li><li><p>主键</p><ul><li>@Id：指定该属性为表的主键</li><li>@IdClass：复合主键</li><li>@GeneratedValue(strategy, generator)：主键生成策略，如 @GeneratedValue(strategy = GenerationType.IDENTITY)，依赖于数据库递增的策略</li><li>@GenericGenerator 自定义主键生成策略 <ul><li>native: 将主键的生成工作交由数据库完成，对于 oracle 采用 Sequence 方式，对于MySQL 和 SQL Server 采用identity（自增主键生成机制）</li><li>org.hibernate.id.UUIDGenerator: 采用128位的uuid算法生成主键，uuid被编码为一个32位16进制数字的字符串</li><li>assigned: 在插入数据的时候主键由程序处理。等同于JPA中的AUTO</li></ul></li></ul></li><li><p>映射</p><ul><li>@Column(name, nullable, length, insertable, updatable)：定义属性和表的映射关系</li><li>@JoinTable(name)、@JoinColumn(name, referencedColumnName)</li><li>@Enumerated</li><li>@Convert(converter)：指定使用的转换器（自定义转换器实现 <code>AttributeConverter&lt;X,Y&gt;</code>）</li><li>@Version 可用于乐观锁并发更新</li></ul></li><li><p>关系</p><ul><li>@OneToOne、@OneToMany、@ManyToOne、@ManyToMany <ul><li>CascadeType.MERGE 级联更新</li><li>CascadeType.PERSIST 级联保存</li><li>CascadeType.REFRESH 级联刷新</li><li>CascadeType.REMOVE 级联删除</li><li>CascadeType.ALL 级联上述4种操作</li></ul></li><li>@OrderBy 对集合排序</li><li>@NamedEntityGraph(name, attributeNodes = {@NamedAttributeNode()}) 命名实体图</li><li>@EntityGraph(value, type=EntityGraphType.FETCH)</li></ul></li></ul><p>spring-data-commons</p><ul><li><code>@Query</code>：自定义语句查询</li><li><code>@Modifying</code>：自定义语句查询涉及到修改、删除时需要加上此注解</li><li><code>@Transient</code>：属性不被持久化</li><li>@CreatedBy、@CreatedDate、@LastModifiedBy、@LastModifiedDate</li><li>@EntityListeners(AuditingEntityListener.class)</li><li>@NoRepositoryBean</li></ul><p>Hibernate</p><ul><li>org.hibernate.annotations</li><li>@CreationTimestamp、@UpdateTimestamp</li><li>@Type(type、parameters)</li></ul><h3 id="操作数据" tabindex="-1">操作数据 <a class="header-anchor" href="#操作数据" aria-label="Permalink to &quot;操作数据&quot;">​</a></h3><ul><li>添加依赖 spring-boot-starter-data-jpa</li><li>@EnableJpaRepositories：启用 JPA 编程</li><li>继承 <code>JpaRepository&lt;T, ID&gt;</code></li></ul><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#C678DD;">public</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">interface</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">CrudRepository</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">ID</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">extends</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">Repository</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">ID</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#E06C75;"> </span><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">S</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">extends</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">S</span><span style="color:#61AFEF;"> save</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">S</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">entity</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">S</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">extends</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">Iterable</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">S</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#61AFEF;"> saveAll</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">Iterable</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">S</span><span style="color:#ABB2BF;">&gt; </span><span style="color:#E06C75;font-style:italic;">entities</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#E5C07B;">Optional</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#61AFEF;"> findById</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">ID</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">id</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#C678DD;">boolean</span><span style="color:#61AFEF;"> existsById</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">ID</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">id</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#E5C07B;">Iterable</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#61AFEF;"> findAll</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#E5C07B;">Iterable</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#61AFEF;"> findAllById</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">Iterable</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">ID</span><span style="color:#ABB2BF;">&gt; </span><span style="color:#E06C75;font-style:italic;">ids</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#C678DD;">long</span><span style="color:#61AFEF;"> count</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#C678DD;">void</span><span style="color:#61AFEF;"> deleteById</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">ID</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">id</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#C678DD;">void</span><span style="color:#61AFEF;"> delete</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">entity</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#C678DD;">void</span><span style="color:#61AFEF;"> deleteAllById</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">Iterable</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">extends</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">ID</span><span style="color:#ABB2BF;">&gt; </span><span style="color:#E06C75;font-style:italic;">ids</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#C678DD;">void</span><span style="color:#61AFEF;"> deleteAll</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">Iterable</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">extends</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">&gt; </span><span style="color:#E06C75;font-style:italic;">entities</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#C678DD;">void</span><span style="color:#61AFEF;"> deleteAll</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">public</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">interface</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">PagingAndSortingRepository</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">ID</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">extends</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">CrudRepository</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">ID</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#E06C75;"> </span><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#E5C07B;">Iterable</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#61AFEF;"> findAll</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">Sort</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">sort</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#E5C07B;">Page</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#61AFEF;"> findAll</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">Pageable</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">pageable</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">public</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">interface</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">JpaRepository</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">ID</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">extends</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">PagingAndSortingRepository</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">ID</span><span style="color:#ABB2BF;">&gt;,</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">QueryByExampleExecutor</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#E06C75;"> </span><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#E5C07B;">List</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#61AFEF;"> findAll</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#E5C07B;">List</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#61AFEF;"> findAll</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">Sort</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">var1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#E5C07B;">List</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#61AFEF;"> findAllById</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">Iterable</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">ID</span><span style="color:#ABB2BF;">&gt; </span><span style="color:#E06C75;font-style:italic;">var1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">S</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">extends</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">List</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">S</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#61AFEF;"> saveAll</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">Iterable</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">S</span><span style="color:#ABB2BF;">&gt; </span><span style="color:#E06C75;font-style:italic;">var1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#C678DD;">void</span><span style="color:#61AFEF;"> flush</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">S</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">extends</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">S</span><span style="color:#61AFEF;"> saveAndFlush</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">S</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">var1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#C678DD;">void</span><span style="color:#61AFEF;"> deleteInBatch</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">Iterable</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">&gt; </span><span style="color:#E06C75;font-style:italic;">var1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#C678DD;">void</span><span style="color:#61AFEF;"> deleteAllInBatch</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#E5C07B;">T</span><span style="color:#61AFEF;"> getOne</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">ID</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">var1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">S</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">extends</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">List</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">S</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#61AFEF;"> findAll</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">Example</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">S</span><span style="color:#ABB2BF;">&gt; </span><span style="color:#E06C75;font-style:italic;">var1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">S</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">extends</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">List</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">S</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#61AFEF;"> findAll</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">Example</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">S</span><span style="color:#ABB2BF;">&gt; </span><span style="color:#E06C75;font-style:italic;">var1</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">Sort</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">var2</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 动态查询</span></span>
<span class="line"><span style="color:#C678DD;">public</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">interface</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">JpaSpecificationExecutor</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#E06C75;"> </span><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#E5C07B;">Optional</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#61AFEF;"> findOne</span><span style="color:#ABB2BF;">(@</span><span style="color:#E5C07B;">Nullable</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Specification</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">&gt; </span><span style="color:#E06C75;font-style:italic;">spec</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#E5C07B;">List</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#61AFEF;"> findAll</span><span style="color:#ABB2BF;">(@</span><span style="color:#E5C07B;">Nullable</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Specification</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">&gt; </span><span style="color:#E06C75;font-style:italic;">spec</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#E5C07B;">Page</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#61AFEF;"> findAll</span><span style="color:#ABB2BF;">(@</span><span style="color:#E5C07B;">Nullable</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Specification</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">&gt; </span><span style="color:#E06C75;font-style:italic;">spec</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">Pageable</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">pageable</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#E5C07B;">List</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#61AFEF;"> findAll</span><span style="color:#ABB2BF;">(@</span><span style="color:#E5C07B;">Nullable</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Specification</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">&gt; </span><span style="color:#E06C75;font-style:italic;">spec</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">Sort</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">sort</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#C678DD;">long</span><span style="color:#61AFEF;"> count</span><span style="color:#ABB2BF;">(@</span><span style="color:#E5C07B;">Nullable</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Specification</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">&gt; </span><span style="color:#E06C75;font-style:italic;">spec</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#C678DD;">boolean</span><span style="color:#61AFEF;"> exists</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">Specification</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">&gt; </span><span style="color:#E06C75;font-style:italic;">spec</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br></div></div><ul><li>按照一定<a href="https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#repository-query-keywords" target="_blank" rel="noreferrer">规则</a>命名的方法可以在不写接口实现的情况下完成逻辑（JPA 会根据方法命名生成 SQL）</li></ul><p><a href="https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#repositories.query-methods" target="_blank" rel="noreferrer">Query Methods</a></p><table><thead><tr><th><strong>Keyword</strong></th><th><strong>Sample</strong></th><th><strong>JPQL snippet</strong></th></tr></thead><tbody><tr><td>Distinct</td><td>findDistinctByLastnameAndFirstname</td><td>select distinct … where x.lastname = ?1 and x.firstname = ?2</td></tr><tr><td>And</td><td>findByLastnameAndFirstname</td><td>… where x.lastname = ?1 and x.firstname = ?2</td></tr><tr><td>Or</td><td>findByLastnameOrFirstname</td><td>… where x.lastname = ?1 or x.firstname = ?2</td></tr><tr><td>Is, Equals</td><td>findByFirstname,findByFirstnameIs,findByFirstnameEquals</td><td>… where x.firstname = ?1</td></tr><tr><td>Between</td><td>findByStartDateBetween</td><td>… where x.startDate between ?1 and ?2</td></tr><tr><td>LessThan</td><td>findByAgeLessThan</td><td>… where x.age &lt; ?1</td></tr><tr><td>LessThanEqual</td><td>findByAgeLessThanEqual</td><td>… where x.age &lt;= ?1</td></tr><tr><td>GreaterThan</td><td>findByAgeGreaterThan</td><td>… where x.age &gt; ?1</td></tr><tr><td>GreaterThanEqual</td><td>findByAgeGreaterThanEqual</td><td>… where x.age &gt;= ?1</td></tr><tr><td>After</td><td>findByStartDateAfter</td><td>… where x.startDate &gt; ?1</td></tr><tr><td>Before</td><td>findByStartDateBefore</td><td>… where x.startDate &lt; ?1</td></tr><tr><td>IsNull, Null</td><td>findByAge(Is)Null</td><td>… where x.age is null</td></tr><tr><td>IsNotNull, NotNull</td><td>findByAge(Is)NotNull</td><td>… where x.age not null</td></tr><tr><td>Like</td><td>findByFirstnameLike</td><td>… where x.firstname like ?1</td></tr><tr><td>NotLike</td><td>findByFirstnameNotLike</td><td>… where x.firstname not like ?1</td></tr><tr><td>StartingWith</td><td>findByFirstnameStartingWith</td><td>… where x.firstname like ?1 (parameter bound with appended %)</td></tr><tr><td>EndingWith</td><td>findByFirstnameEndingWith</td><td>… where x.firstname like ?1 (parameter bound with prepended %)</td></tr><tr><td>Containing</td><td>findByFirstnameContaining</td><td>… where x.firstname like ?1 (parameter bound wrapped in %)</td></tr><tr><td>OrderBy</td><td>findByAgeOrderByLastnameDesc</td><td>… where x.age = ?1 order by x.lastname desc</td></tr><tr><td>Not</td><td>findByLastnameNot</td><td>… where x.lastname <code>&lt;&gt; ?1</code></td></tr><tr><td>In</td><td>findByAgeIn(<code>Collection&lt;Age&gt;</code> ages)</td><td>… where x.age in ?1</td></tr><tr><td>NotIn</td><td>findByAgeNotIn(<code>Collection&lt;Age&gt;</code> ages)</td><td>… where x.age not in ?1</td></tr><tr><td>True</td><td>findByActiveTrue()</td><td>… where x.active = true</td></tr><tr><td>False</td><td>findByActiveFalse()</td><td>… where x.active = false</td></tr><tr><td>IgnoreCase</td><td>findByFirstnameIgnoreCase</td><td>… where UPPER(x.firstname) = UPPER(?1)</td></tr></tbody></table><p><strong>Query subject keywords</strong></p><table><thead><tr><th><strong>Keyword</strong></th><th><strong>Description</strong></th></tr></thead><tbody><tr><td>find…By, read…By, <br> get…By, query…By, search…By, stream…By</td><td>General query method returning typically the repository type, a Collection or Streamable subtype or a result wrapper such as Page, GeoResults or any other store-specific result wrapper. Can be used as findBy…, findMyDomainTypeBy… or in combination with additional keywords.</td></tr><tr><td>exists…By</td><td>Exists projection, returning typically a boolean result.</td></tr><tr><td>count…By</td><td>Count projection returning a numeric result.</td></tr><tr><td>delete…By, remove…By</td><td>Delete query method returning either no result (void) or the delete count.</td></tr><tr><td>…First<code>&lt;number&gt;</code>…, …Top<code>&lt;number&gt;</code>…</td><td>Limit the query results to the first <code>&lt;number&gt;</code> of results. This keyword can occur in any place of the subject between find (and the other keywords) and by.</td></tr><tr><td>…Distinct…</td><td>Use a distinct query to return only unique results. Consult the store-specific documentation whether that feature is supported. This keyword can occur in any place of the subject between find (and the other keywords) and by.</td></tr></tbody></table><p><strong>Query return types</strong></p><table><thead><tr><th><strong>Return type</strong></th><th><strong>Description</strong></th></tr></thead><tbody><tr><td>void</td><td>Denotes no return value.</td></tr><tr><td>Primitives</td><td>Java primitives.</td></tr><tr><td>Wrapper types</td><td>Java wrapper types.</td></tr><tr><td>T</td><td>A unique entity. Expects the query method to return one result at most. If no result is found, null is returned. More than one result triggers an IncorrectResultSizeDataAccessException.</td></tr><tr><td><code>Iterator&lt;T&gt;</code></td><td>An Iterator.</td></tr><tr><td><code>Collection&lt;T&gt;</code></td><td>A Collection.</td></tr><tr><td><code>List&lt;T&gt;</code></td><td>A List.</td></tr><tr><td><code>Optional&lt;T&gt;</code></td><td>A Java 8 or Guava Optional.</td></tr><tr><td><code>Option&lt;T&gt;</code></td><td>Either a Scala or Vavr Option type. Semantically the same behavior as Java 8’s Optional, described earlier.</td></tr><tr><td><code>Stream&lt;T&gt;</code></td><td>A Java 8 Stream.</td></tr><tr><td><code>Streamable&lt;T&gt;</code></td><td>A convenience extension of Iterable that directy exposes methods to stream, map and filter results, concatenate them etc.</td></tr><tr><td>Types that implement Streamable and take a Streamable constructor or factory method argument</td><td>Types that expose a constructor or ….of(…)/….valueOf(…) factory method taking a Streamable as argument.</td></tr><tr><td>Vavr Seq, List, Map, Set</td><td>Vavr collection types. See <a href="https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#repositories.collections-and-iterables.vavr" target="_blank" rel="noreferrer">Support for Vavr Collections</a> for details.</td></tr><tr><td><code>Future&lt;T&gt;</code></td><td>Expects a method to be annotated with @Async and requires Spring’s asynchronous method execution capability to be enabled.</td></tr><tr><td><code>CompletableFuture&lt;T&gt;</code></td><td>Expects a method to be annotated with @Async and requires Spring’s asynchronous method execution capability to be enabled.</td></tr><tr><td>ListenableFuture</td><td>A org.springframework.util.concurrent.ListenableFuture. Expects a method to be annotated with @Async and requires Spring’s asynchronous method execution capability to be enabled.</td></tr><tr><td><code>Slice&lt;T&gt;</code></td><td>A sized chunk of data with an indication of whether there is more data available. Requires a Pageable method parameter.</td></tr><tr><td><code>Page&lt;T&gt;</code></td><td>A Slice with additional information, such as the total number of results. Requires a Pageable method parameter.</td></tr><tr><td><code>GeoResult&lt;T&gt;</code></td><td>A result entry with additional information, such as the distance to a reference location.</td></tr><tr><td><code>GeoResults&lt;T&gt;</code></td><td>A list of <code>GeoResult&lt;T&gt;</code> with additional information, such as the average distance to a reference location.</td></tr><tr><td><code>GeoPage&lt;T&gt;</code></td><td>A Page with <code>GeoResult&lt;T&gt;</code>, such as the average distance to a reference location.</td></tr></tbody></table><p><strong>示例</strong> <br> 数据库基础配置</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#E06C75;">spring</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">jpa</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">hibernate</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">naming</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">physical-strategy</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;"># 自动创建、更新、验证数据库表结构</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">ddl-auto</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">update</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">properties</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">hibernate</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">dialect</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">org.hibernate.dialect.MySQLDialect</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">new_generator_mappings</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">false</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">format_sql</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">true</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">show-sql</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">true</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">datasource</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">url</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">jdbc:mysql://localhost:3306/ss?serverTimezone=UTC&amp;useSSL=false&amp;autoReconnect=true&amp;tinyInt1isBit=false&amp;useUnicode=true&amp;characterEncoding=utf8</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">username</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">root</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">password</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">123qwe</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span></span>
<span class="line"><span style="color:#ABB2BF;">    </span></span>
<span class="line"><span style="color:#E06C75;">logging</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">level</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">org.hibernate.SQL</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">debug</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">org.hibernate.engine.QueryParameters</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">debug</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">org.hibernate.engine.query.HQLQueryPlan</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">debug</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">org.hibernate.type.descriptor.sql.BasicBinder</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">trace</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>ddl-auto</p><ul><li>none 不指定数据库初始化模式</li><li>create 每次启动删除并重新创建数据库</li><li>create-drop 每次程序结束的时会清空表</li><li>validate 检查数据库中的表与实体类是否匹配，不匹配报错</li><li>update 每次运行程序，新建表或更新表结构，但是表内有数据不会被清空</li></ul><p>编写一个对应数据库表的实体类</p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Entity</span></span>
<span class="line"><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Table</span><span style="color:#E06C75;">(</span><span style="color:#D19A66;">name</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#98C379;">&quot;books&quot;</span><span style="color:#E06C75;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Data</span></span>
<span class="line"><span style="color:#C678DD;">public</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">class</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">Book</span><span style="color:#E06C75;"> </span><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Id</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">GeneratedValue</span><span style="color:#E06C75;">(</span><span style="color:#D19A66;">strategy</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">GenerationType</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">AUTO</span><span style="color:#E06C75;">)</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Column</span><span style="color:#E06C75;">(</span><span style="color:#D19A66;">name</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#98C379;">&quot;book_id&quot;</span><span style="color:#E06C75;">)</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#C678DD;">private</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">int</span><span style="color:#E06C75;"> bookId</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">    </span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#7F848E;font-style:italic;">// 用来跟表的字段做个映射，如果名字相同就不需要写</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Column</span><span style="color:#E06C75;">(</span><span style="color:#D19A66;">name</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#98C379;">&quot;title&quot;</span><span style="color:#E06C75;">)</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#C678DD;">private</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">String</span><span style="color:#E06C75;"> title</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">    </span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Column</span><span style="color:#E06C75;">(</span><span style="color:#D19A66;">name</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#98C379;">&quot;category&quot;</span><span style="color:#E06C75;">)</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#C678DD;">private</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">String</span><span style="color:#E06C75;"> category</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">    </span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#7F848E;font-style:italic;">// get、set...</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 对于from后的子查询，需要将select子查询到的虚拟表建立一个实体类映射成一个虚拟视图，再进行关联查询操作</span></span>
<span class="line"><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Entity</span></span>
<span class="line"><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Subselect</span><span style="color:#E06C75;">(</span><span style="color:#98C379;">&quot;native sql Query&quot;</span><span style="color:#E06C75;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Synchronize</span><span style="color:#E06C75;">({</span><span style="color:#98C379;">&quot;table&quot;</span><span style="color:#E06C75;">})</span></span>
<span class="line"><span style="color:#C678DD;">public</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">class</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">Temp</span><span style="color:#ABB2BF;">{</span><span style="color:#E06C75;"> </span><span style="color:#ABB2BF;">...</span><span style="color:#E06C75;"> </span><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>编写持久层，实现一个类（JpaRepository 或 CrudRepository）</p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#C678DD;">public</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">interface</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">BookDao</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">extends</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">CrudRepository</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">Book</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">Long</span><span style="color:#ABB2BF;">&gt;{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Query</span><span style="color:#E06C75;">(</span><span style="color:#98C379;">&quot;select * from Book b where b.title=:title&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> </span><span style="color:#D19A66;">nativeQuery</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#D19A66;">true</span><span style="color:#E06C75;">)</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#C678DD;">public</span><span style="color:#61AFEF;"> </span><span style="color:#E5C07B;">Book</span><span style="color:#61AFEF;"> findBookByTitle</span><span style="color:#ABB2BF;">(@</span><span style="color:#E5C07B;">Param</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;title&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#E5C07B;">String</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">title</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;">    </span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Query</span><span style="color:#E06C75;">(</span><span style="color:#98C379;">&quot;select * from Book b where b.category=:category&quot;</span><span style="color:#E06C75;">)</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#C678DD;">public</span><span style="color:#61AFEF;"> </span><span style="color:#E5C07B;">Page</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">Book</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#61AFEF;"> findBooksByCategory</span><span style="color:#ABB2BF;">(@</span><span style="color:#E5C07B;">Param</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;category&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#E5C07B;">String</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">category</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">Pageable</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">pageable</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>使用</p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Autowired</span></span>
<span class="line"><span style="color:#C678DD;">private</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">UserDao</span><span style="color:#E06C75;"> userDao</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Test</span></span>
<span class="line"><span style="color:#C678DD;">public</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">void</span><span style="color:#E06C75;"> </span><span style="color:#61AFEF;">getBooksPageable</span><span style="color:#E06C75;">()</span></span>
<span class="line"><span style="color:#E06C75;">{</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#C678DD;">int</span><span style="color:#E06C75;"> pageIndex </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span><span style="color:#E06C75;"> </span><span style="color:#7F848E;font-style:italic;">//当前页码（第一页从0开始）</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#C678DD;">int</span><span style="color:#E06C75;"> pageSize </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">;</span><span style="color:#E06C75;"> </span><span style="color:#7F848E;font-style:italic;">//分页大小</span></span>
<span class="line"><span style="color:#E06C75;">    </span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#7F848E;font-style:italic;">//排序</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#E5C07B;">Sort</span><span style="color:#E06C75;"> sort </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">Sort</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">by</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">Sort</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">Direction</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">ASC</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;title&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;"> </span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#7F848E;font-style:italic;">//分页</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#E5C07B;">Pageable</span><span style="color:#E06C75;"> pageable </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">PageRequest</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">of</span><span style="color:#ABB2BF;">(pageIndex, pageSize, sort);</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#E5C07B;">Page</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">Book</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#E06C75;"> Books </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">BookDao</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">findBooksByCategory</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;computer&quot;</span><span style="color:#ABB2BF;">, pageable);</span></span>
<span class="line"><span style="color:#E06C75;"> </span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#7F848E;font-style:italic;">//数据列表</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#E5C07B;">List</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">Book</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#E06C75;"> BookList </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">Books</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getContent</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#C678DD;">for</span><span style="color:#E06C75;"> (</span><span style="color:#E5C07B;">Book</span><span style="color:#E06C75;"> book </span><span style="color:#C678DD;">:</span><span style="color:#E06C75;"> BookList){</span></span>
<span class="line"><span style="color:#E06C75;">        </span><span style="color:#E5C07B;">System</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">out</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">println</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">book</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">toString</span><span style="color:#ABB2BF;">());</span></span>
<span class="line"><span style="color:#E06C75;">    }</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#7F848E;font-style:italic;">//分页信息</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#E5C07B;">System</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">out</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">println</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;当前页码：第&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">Books</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getNumber</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;页&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#E5C07B;">System</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">out</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">println</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;分页大小：每页&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Books</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getSize</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;条&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#E5C07B;">System</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">out</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">println</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;数据总数：共&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Books</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getTotalElements</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;条&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#E5C07B;">System</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">out</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">println</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;总页数：共&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Books</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getTotalPages</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;页&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#E5C07B;">System</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">out</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">println</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;排序信息：&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Books</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getSort</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">toString</span><span style="color:#ABB2BF;">());</span></span>
<span class="line"><span style="color:#E06C75;">}   </span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h3 id="审计-auditing" tabindex="-1">审计 Auditing <a class="header-anchor" href="#审计-auditing" aria-label="Permalink to &quot;审计 Auditing&quot;">​</a></h3><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// 实体类</span></span>
<span class="line"><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Entity</span></span>
<span class="line"><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">EntityListeners</span><span style="color:#E06C75;">(</span><span style="color:#E5C07B;">AuditingEntityListener</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">class</span><span style="color:#E06C75;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Table</span><span style="color:#E06C75;">(</span><span style="color:#D19A66;">name</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#98C379;">&quot;tb_user&quot;</span><span style="color:#E06C75;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Data</span></span>
<span class="line"><span style="color:#C678DD;">public</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">class</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">User</span><span style="color:#E06C75;"> </span><span style="color:#ABB2BF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Id</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">GenericGenerator</span><span style="color:#E06C75;">(</span><span style="color:#D19A66;">name</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#98C379;">&quot;idGenerator&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> </span><span style="color:#D19A66;">strategy</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#98C379;">&quot;uuid&quot;</span><span style="color:#E06C75;">)</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">GeneratedValue</span><span style="color:#E06C75;">(</span><span style="color:#D19A66;">generator</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#98C379;">&quot;idGenerator&quot;</span><span style="color:#E06C75;">)</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#C678DD;">private</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">String</span><span style="color:#E06C75;"> id</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Column</span><span style="color:#E06C75;">(</span><span style="color:#D19A66;">name</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#98C379;">&quot;username&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> </span><span style="color:#D19A66;">unique</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> </span><span style="color:#D19A66;">nullable</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#D19A66;">false</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> </span><span style="color:#D19A66;">length</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#D19A66;">64</span><span style="color:#E06C75;">)</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#C678DD;">private</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">String</span><span style="color:#E06C75;"> username</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Column</span><span style="color:#E06C75;">(</span><span style="color:#D19A66;">name</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#98C379;">&quot;password&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> </span><span style="color:#D19A66;">nullable</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#D19A66;">false</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> </span><span style="color:#D19A66;">length</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#D19A66;">64</span><span style="color:#E06C75;">)</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#C678DD;">private</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">String</span><span style="color:#E06C75;"> password</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Column</span><span style="color:#E06C75;">(</span><span style="color:#D19A66;">name</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#98C379;">&quot;email&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> </span><span style="color:#D19A66;">unique</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> </span><span style="color:#D19A66;">length</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#D19A66;">64</span><span style="color:#E06C75;">)</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#C678DD;">private</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">String</span><span style="color:#E06C75;"> email</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">ManyToMany</span><span style="color:#E06C75;">(</span><span style="color:#D19A66;">targetEntity</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">Role</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">class</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> </span><span style="color:#D19A66;">cascade</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">CascadeType</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">ALL</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> </span><span style="color:#D19A66;">fetch</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">FetchType</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">LAZY</span><span style="color:#E06C75;">)</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">JoinTable</span><span style="color:#E06C75;">(</span><span style="color:#D19A66;">name</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#98C379;">&quot;tb_user_role&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> </span><span style="color:#D19A66;">joinColumns</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> {</span><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">JoinColumn</span><span style="color:#E06C75;">(</span><span style="color:#D19A66;">name</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#98C379;">&quot;user_id&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> </span><span style="color:#D19A66;">referencedColumnName</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#98C379;">&quot;id&quot;</span><span style="color:#E06C75;">)}</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">            </span><span style="color:#D19A66;">inverseJoinColumns</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> {</span><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">JoinColumn</span><span style="color:#E06C75;">(</span><span style="color:#D19A66;">name</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#98C379;">&quot;role_id&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> </span><span style="color:#D19A66;">referencedColumnName</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#98C379;">&quot;id&quot;</span><span style="color:#E06C75;">)})</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#C678DD;">private</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">Set</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">Role</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#E06C75;"> roles</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">CreatedDate</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Column</span><span style="color:#E06C75;">(</span><span style="color:#D19A66;">name</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#98C379;">&quot;created_date&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> </span><span style="color:#D19A66;">updatable</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#D19A66;">false</span><span style="color:#E06C75;">)</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#C678DD;">private</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">Date</span><span style="color:#E06C75;"> createdDate</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">CreatedBy</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Column</span><span style="color:#E06C75;">(</span><span style="color:#D19A66;">name</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#98C379;">&quot;created_by&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> </span><span style="color:#D19A66;">updatable</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#D19A66;">false</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> </span><span style="color:#D19A66;">length</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#D19A66;">64</span><span style="color:#E06C75;">)</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#C678DD;">private</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">String</span><span style="color:#E06C75;"> createdBy</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">LastModifiedDate</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Column</span><span style="color:#E06C75;">(</span><span style="color:#D19A66;">name</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#98C379;">&quot;updated_date&quot;</span><span style="color:#E06C75;">)</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#C678DD;">private</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">Date</span><span style="color:#E06C75;"> updatedDate</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">LastModifiedBy</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Column</span><span style="color:#E06C75;">(</span><span style="color:#D19A66;">name</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#98C379;">&quot;updated_by&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> </span><span style="color:#D19A66;">length</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#D19A66;">64</span><span style="color:#E06C75;">)</span></span>
<span class="line"><span style="color:#E06C75;">    </span><span style="color:#C678DD;">private</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">String</span><span style="color:#E06C75;"> updatedBy</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 实现AuditorAware</span></span>
<span class="line"><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Configuration</span></span>
<span class="line"><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">EnableJpaAuditing</span></span>
<span class="line"><span style="color:#C678DD;">public</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">class</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">JpaAuditingConfiguration</span><span style="color:#E06C75;"> </span><span style="color:#ABB2BF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Bean</span></span>
<span class="line"><span style="color:#E06C75;">  </span><span style="color:#C678DD;">public</span><span style="color:#61AFEF;"> </span><span style="color:#E5C07B;">AuditorAware</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">String</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#61AFEF;"> auditorProvider</span><span style="color:#ABB2BF;">()</span><span style="color:#61AFEF;"> </span><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> () </span><span style="color:#C678DD;">-&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Optional</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">of</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;system&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br></div></div><h2 id="druid" tabindex="-1"><a href="https://github.com/alibaba/druid" target="_blank" rel="noreferrer">Druid</a> <a class="header-anchor" href="#druid" aria-label="Permalink to &quot;[Druid](https://github.com/alibaba/druid)&quot;">​</a></h2><p>数据库连接池，提供强大的监控和扩展功能 <br> web: <a href="http://localhost/demo/druid" target="_blank" rel="noreferrer">http://localhost/druid</a></p><p>druid-spring-boot-starter</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki one-dark-pro"><code><span class="line"><span style="color:#E06C75;">spring</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">datasource</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">druid</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">db-type</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">com.alibaba.druid.pool.DruidDataSource</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">driverClassName</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">com.mysql.cj.jdbc.Driver</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">url</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">jdbc:mysql://\${DB_HOST:localhost}:\${DB_PORT:3306}/\${DB_NAME:web}?serverTimezone=Asia/Shanghai&amp;characterEncoding=utf8&amp;useSSL=false</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">username</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">\${DB_USER:root}</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">password</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">\${DB_PWD:mysql8}</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;"># 初始连接数</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">initial-size</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">5</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;"># 最小连接数</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">min-idle</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">15</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;"># 最大连接数</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">max-active</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">30</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;"># 超时时间(以秒数为单位)</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">remove-abandoned-timeout</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">180</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;"># 获取连接超时时间</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">max-wait</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">3000</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;"># 连接有效性检测时间</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">time-between-eviction-runs-millis</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">60000</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;"># 连接在池中最小生存的时间</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">min-evictable-idle-time-millis</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">300000</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;"># 连接在池中最大生存的时间</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">max-evictable-idle-time-millis</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">900000</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;"># 指明连接是否被空闲连接回收器(如果有)进行检验.如果检测失败,则连接将被从池中去除</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">test-while-idle</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">true</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;"># 指明是否在从池中取出连接前进行检验,如果检验失败, 则从池中去除连接并尝试取出另一个</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">test-on-borrow</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">true</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;"># 是否在归还到池中前进行检验</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">test-on-return</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">false</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;"># 检测连接是否有效</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">validation-query</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">select 1</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;"># 配置监控统计 WebStatFilter（StatFilter监控器中的Web模板）</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">web-stat-filter</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">enabled</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;"># 开启 WebStatFilter，即开启监控功能中的 Web 监控功能</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">url-pattern</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">/*</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;"># 映射地址，即统计指定地址的web请求</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">exclusions</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;*.js,*.gif,*.jpg,*.png,*.css,*.ico,/druid/*&#39;</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;"># 不统计的web请求，如下是不统计静态资源及druid监控页面本身的请求</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">session-stat-enable</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;"># 是否启用session统计</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">session-stat-max-count</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;"># session统计的最大个数，默认是1000。当统计超过这个数，只统计最新的</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">principal-session-name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">userName</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;"># 所存用户信息的serssion参数名。Druid会依照此参数名读取相应session对应的用户名记录下来（在监控页面可看到）。如果指定参数不是基础数据类型，将会自动调用相应参数对象的toString方法来取值</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">principal-cookie-name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">userName</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;"># 与上类似，但这是通过Cookie名取到用户信息</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">profile-enable</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;"># 监控单个url调用的sql列表</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;"># StatViewServlet监控器。开启后，访问http://域名/druid/index.html</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">stat-view-servlet</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">enabled</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">true</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;"># 监控后台账号和密码</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">login-password</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">admin</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">login-username</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">admin</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">url-pattern</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">/druid/*</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">reset-enable</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">false</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">allow</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">127.0.0.1,192.168.1.0/24</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;"># 监控页面访问白名单。默认为127.0.0.1。支持子网掩码</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">deny</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">4.4.4.4</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;"># 监控页面访问黑名单</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">filter</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">stat</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#E06C75;">enabled</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">true</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#7F848E;font-style:italic;"># 记录慢SQL</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#E06C75;">log-slow-sql</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">true</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#E06C75;">slow-sql-millis</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1000</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#E06C75;">merge-sql</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">true</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">wall</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;">enabled</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;">  </span><span style="color:#7F848E;font-style:italic;"># 开启SQL防火墙功能</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#E06C75;">config</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">multi-statement-allow</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">true</span></span>
<span class="line"><span style="color:#E06C75;">select-allow</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;"># 允许执行Select查询操作</span></span>
<span class="line"><span style="color:#E06C75;">delete-allow</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">false</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;"># 不允许执行delete操作</span></span>
<span class="line"><span style="color:#E06C75;">create-table-allow</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">false</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;"># 不允许创建表</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br></div></div><h2 id="h2database" tabindex="-1"><a href="https://github.com/h2database/h2database" target="_blank" rel="noreferrer">h2database</a> <a class="header-anchor" href="#h2database" aria-label="Permalink to &quot;[h2database](https://github.com/h2database/h2database)&quot;">​</a></h2><p>一个用Java开发的嵌入式数据库，本身只是一个类库</p>`,64),e=[o];function t(r,c,B,y,i,A){return a(),n("div",null,e)}const b=s(p,[["render",t]]);export{C as __pageData,b as default};
